{% extends "base.html" %}
{% block style %}
<link rel="stylesheet" href="/static/books/book.css">
{% endblock %}

{% block content %}
<main class="relative flex items-center justify-center w-full" style="background:#fff;">
    <!-- Loading Spinner Overlay -->
    <div id="book-loading-spinner"
        class="absolute inset-0 z-50 flex items-center justify-center bg-white bg-opacity-85">
        <div class="flex flex-col items-center">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 496" width="48" height="48" class="mb-4 spinner">
                <path style="fill:#76BFFF"
                    d="M248 92c-13.6 0-24-10.4-24-24V24c0-13.6 10.4-24 24-24s24 10.4 24 24v44c0 12.8-10.4 24-24 24" />
                <path style="fill:#0A4ABF"
                    d="M248 496c-13.6 0-24-10.4-24-24v-44c0-13.6 10.4-24 24-24s24 10.4 24 24v44c0 13.6-10.4 24-24 24" />
                <path style="fill:#B3D9FF"
                    d="M157.6 116c-8 0-16-4-20.8-12l-21.6-37.6c-6.4-11.2-2.4-26.4 8.8-32.8s26.4-2.4 32.8 8.8L178.4 80c6.4 11.2 2.4 26.4-8.8 32.8-3.2 1.6-8 3.2-12 3.2" />
                <path style="fill:#1B6ED1"
                    d="M360 465.6c-8 0-16-4-20.8-12L317.6 416c-6.4-11.2-2.4-26.4 8.8-32.8s26.4-2.4 32.8 8.8l21.6 37.6c6.4 11.2 2.4 26.4-8.8 32.8-4 2.4-8 3.2-12 3.2" />
                <path style="fill:#E6F3FF"
                    d="M92 181.6c-4 0-8-.8-12-3.2l-37.6-21.6c-11.2-6.4-15.2-21.6-8.8-32.8s21.6-15.2 32.8-8.8l37.6 21.6c11.2 6.4 15.2 21.6 8.8 32.8-4.8 8-12.8 12-20.8 12" />
                <path style="fill:#2580D6"
                    d="M442.4 384c-4 0-8-.8-12-3.2L392 359.2c-11.2-6.4-15.2-21.6-8.8-32.8s21.6-15.2 32.8-8.8l37.6 21.6c11.2 6.4 15.2 21.6 8.8 32.8-4 8-12 12-20 12" />
                <path style="fill:#F0F8FF"
                    d="M68 272H24c-13.6 0-24-10.4-24-24s10.4-24 24-24h44c13.6 0 24 10.4 24 24s-11.2 24-24 24" />
                <path style="fill:#3B94F2"
                    d="M472 272h-44c-13.6 0-24-10.4-24-24s10.4-24 24-24h44c13.6 0 24 10.4 24 24s-10.4 24-24 24" />
                <path style="fill:#0F5DBA"
                    d="M53.6 384c-8 0-16-4-20.8-12-6.4-11.2-2.4-26.4 8.8-32.8l37.6-21.6c11.2-6.4 26.4-2.4 32.8 8.8s2.4 26.4-8.8 32.8l-37.6 21.6c-3.2 2.4-7.2 3.2-12 3.2" />
                <path style="fill:#55AEF7"
                    d="M404 181.6c-8 0-16-4-20.8-12-6.4-11.2-2.4-26.4 8.8-32.8l37.6-21.6c11.2-6.4 26.4-2.4 32.8 8.8s2.4 26.4-8.8 32.8L416 178.4c-4 2.4-8 3.2-12 3.2" />
                <path style="fill:#0B51C5"
                    d="M136 465.6c-4 0-8-.8-12-3.2-11.2-6.4-15.2-21.6-8.8-32.8l21.6-37.6c6.4-11.2 21.6-15.2 32.8-8.8s15.2 21.6 8.8 32.8l-21.6 37.6c-4.8 8-12.8 12-20.8 12" />
                <path style="fill:#57C4FF"
                    d="M338.4 116c-4 0-8-.8-12-3.2-11.2-6.4-15.2-21.6-8.8-32.8l21.6-37.6c6.4-11.2 21.6-15.2 32.8-8.8s15.2 21.6 8.8 32.8L359.2 104c-4.8 7.2-12.8 12-20.8 12" />
            </svg>
        </div>
    </div>

    <div class="px-4 sm:px-6 lg:px-8 py-12">
        <div class="grid grid-cols-1 lg:grid-cols-5 gap-12 mb-16">
            <!-- Book Cover -->
            <div class="lg:col-span-2">
                <div class="sticky top-8">
                    <div class="relative bg-white rounded-lg p-6">
                        <img id="bookCover"
                            src="https://via.placeholder.com/400x600/1e293b/FFFFFF?text=Professional+Book"
                            alt="Book Cover"
                            class="w-full max-w-sm mx-auto h-auto object-cover rounded-lg book-cover-shadow">
                    </div>
                </div>
            </div>

            <!-- Book Details -->
            <div class="lg:col-span-3 space-y-8 fade-in">
                <div class="space-y-4">
                    <h1 id="bookTitle" class="text-4xl font-bold text-gray-900 leading-tight">Loading...</h1>
                    <p id="bookAuthor" class="text-xl text-gray-600">by <span
                            class="font-semibold text-gray-700">Loading...</span></p>
                    <!-- Rating -->
                    <div class="flex items-center space-x-4">
                        <div id="starRating" class="flex items-center star-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="far fa-star"></i>
                        </div>
                        <span id="ratingValue" class="text-gray-600 font-medium">(4.0)</span>
                    </div>
                    <!-- Availability Status -->
                    <div id="availabilityBadge"
                        class="inline-flex items-center px-4 py-2 rounded-full text-sm font-semibold bg-green-50 text-green-700 border border-green-200 availability-badge">
                        <i class="fas fa-circle text-green-500 mr-2 text-xs"></i>
                        Available
                    </div>
                </div>
                <!-- Book Info Grid -->
                <div class="info-card rounded-xl p-6 book-meta-grid">
                    <div class="space-y-1">
                        <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider">Category</h3>
                        <p id="bookCategory" class="text-gray-900 font-medium">Loading...</p>
                    </div>
                    <div class="space-y-1">
                        <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider">Published</h3>
                        <p id="bookYear" class="text-gray-900 font-medium">Loading...</p>
                    </div>
                    <div class="space-y-1">
                        <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider">Language</h3>
                        <p id="bookLanguage" class="text-gray-900 font-medium">Loading...</p>
                    </div>
                    <div class="space-y-1">
                        <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider">ISBN</h3>
                        <p id="bookISBN" class="text-gray-900 font-medium">Loading...</p>
                    </div>
                    <div class="space-y-1">
                        <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider">Publisher</h3>
                        <p id="bookPublisher" class="text-gray-900 font-medium">Loading...</p>
                    </div>
                    <div class="space-y-1">
                        <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider">Format</h3>
                        <p id="storageType" class="text-gray-900 font-medium">Loading...</p>
                    </div>
                </div>
                <!-- Action Buttons -->
                <div class="space-y-4">
                    <button id="borrowBtn" class="w-full action-button text-white py-4 px-6 rounded-xl font-semibold">
                        <i class="fas fa-book-open mr-2"></i>
                        Request to Borrow
                    </button>
                    <button id="onlineBtn"
                        class="w-full secondary-button text-gray-700 py-4 px-6 rounded-xl font-semibold"
                        style="display:none;">
                        <i class="fas fa-external-link-alt mr-2"></i>
                        Access Online
                    </button>
                    <div id="offlineAddress">
                    </div>
                </div>
            </div>
        </div>
        <!-- Borrow Modal -->
        <div id="borrow-modal" class="fixed inset-0 flex items-center justify-center modal-overlay z-50 hidden">
            <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md mx-4 relative">
                <button id="close-modal"
                    class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 text-2xl">&times;</button>
                <div class="text-center mb-6">
                    <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 mb-4">
                        <i class="fas fa-book-open text-blue-600"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900">Request to Borrow</h3>
                    <p class="text-gray-600 mt-2">Please provide details for your borrow request</p>
                </div>
                <form id="borrow-form" class="space-y-6">
                    <input type="hidden" id="modal-book-id">
                    <div>
                        <label for="request_description" class="block text-sm font-semibold text-gray-700 mb-2">Purpose
                            of
                            Request</label>
                        <textarea id="request_description" rows="4"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            placeholder="Please describe why you need this book..." required></textarea>
                    </div>
                    <div>
                        <label for="return_date" class="block text-sm font-semibold text-gray-700 mb-2">Expected Return
                            Date</label>
                        <input type="date" id="return_date"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            required>
                    </div>
                    <button type="submit" class="w-full action-button text-white py-3 px-6 rounded-lg font-semibold">
                        <i class="fas fa-paper-plane mr-2"></i>
                        Submit Request
                    </button>
                </form>
            </div>
        </div>
        <!-- Related Books Section -->
        <div class="mt-20">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-2xl font-bold text-gray-900">Related Books in <span id="categoryName">this
                        category</span>
                </h2>
                <a href="#" class="text-blue-600 hover:text-blue-700 font-semibold text-sm">View All</a>
            </div>
            <div id="relatedBooks" class="related-books-grid">
                <!-- Related books will be loaded here -->
            </div>
        </div>
    </div>
</main>
{% endblock %}

{% block scripts %}
<script src="/static/books/book.js"></script>
{% endblock %}